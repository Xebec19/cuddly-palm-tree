const a7_0x1ec8=['unparse','length','completedTasks','rxjs/internal/Observable','catch','addDependencies','hash','dependencies','../../../utilities/create-no-new-messages-timeout','error','encryptionKey','See\x20run\x20details\x20at\x20','exit','runUrl','url','retrieve','./node_modules/.cache/nx','taskId','E2EEncryption','scheduleTask','COMPLETED','@nrwl/workspace/src/utilities/output','Distributed\x20Execution\x20Terminated','getDependencyConfigs','done','configuration','submitRunMetrics','nxCloudDistributedTasksRunner','Starting\x20distributed\x20command\x20execution','logCommand','project','completeRunGroupWithError','output','ENCRYPTION_KEY','parse','createTaskGraph','write','copyFilesFromCache','add','finally','Observable','log','../../file-storage/e2e-encryption','cacheDirectory','next','Status\x20update','startTask','run','@nrwl/workspace/src/tasks-runner/cache','keys','note','error:\x20','lifeCycle','executionId:\x20','@nrwl/workspace/src/tasks-runner/utils','filter','../../../utilities/metric-logger','createNoNewMessagesTimeout','defaultTargetDependencies','createStartRequest','executionStatus:\x20','TaskGraphCreator','wait','overrides','value','../../../utilities/waiter','indexOf','Unable\x20to\x20complete\x20a\x20run.','Cache','self','strictlyOrderedTargets','Error:','./distributed-execution.api','then','nx.json','has','FileStorage','addTaskToGraph','start','message','getOutputs','strip-json-comments','nodes','VERBOSE_LOGGING','tasks','findTask','apply','projects','splitTasksIntoStages','addVerticalSeparator','projectGraph','Waiting...','__esModule','Waiter','axiosException','targetDependencies','__awaiter','push','size','find','map','assign','join','target','commandStatus','Retrieving\x20artifacts\x20from\x20'];(function(_0x3f91b7,_0x1ec8af){const _0x15eccc=function(_0x3c9af0){while(--_0x3c9af0){_0x3f91b7['push'](_0x3f91b7['shift']());}};_0x15eccc(++_0x1ec8af);}(a7_0x1ec8,0x16f));const a7_0x15ec=function(_0x3f91b7,_0x1ec8af){_0x3f91b7=_0x3f91b7-0x0;let _0x15eccc=a7_0x1ec8[_0x3f91b7];return _0x15eccc;};'use strict';var __awaiter=this&&this[a7_0x15ec('0x2f')]||function(_0x9a7f40,_0x18b799,_0x4bebaa,_0x1cf49e){function _0x3e6158(_0x4ce43d){return _0x4ce43d instanceof _0x4bebaa?_0x4ce43d:new _0x4bebaa(function(_0x3884dc){_0x3884dc(_0x4ce43d);});}return new(_0x4bebaa||(_0x4bebaa=Promise))(function(_0x187b2a,_0x3870c3){function _0x377317(_0xf2aa3f){try{_0x3a9837(_0x1cf49e[a7_0x15ec('0x65')](_0xf2aa3f));}catch(_0x144a71){_0x3870c3(_0x144a71);}}function _0x4d00c7(_0xa14300){try{_0x3a9837(_0x1cf49e['throw'](_0xa14300));}catch(_0x416cf7){_0x3870c3(_0x416cf7);}}function _0x3a9837(_0x1c771e){_0x1c771e[a7_0x15ec('0x51')]?_0x187b2a(_0x1c771e[a7_0x15ec('0xf')]):_0x3e6158(_0x1c771e[a7_0x15ec('0xf')])[a7_0x15ec('0x18')](_0x377317,_0x4d00c7);}_0x3a9837((_0x1cf49e=_0x1cf49e[a7_0x15ec('0x25')](_0x9a7f40,_0x18b799||[]))[a7_0x15ec('0x65')]());});};Object['defineProperty'](exports,a7_0x15ec('0x2b'),{'value':!![]});exports[a7_0x15ec('0xc')]=exports[a7_0x15ec('0x54')]=void 0x0;const Observable_1=require(a7_0x15ec('0x3c'));const cache_1=require(a7_0x15ec('0x69'));const output_1=require(a7_0x15ec('0x4e'));const utils_1=require(a7_0x15ec('0x5'));const stripJsonComments=require(a7_0x15ec('0x20'));const fs_1=require('fs');const distributed_execution_api_1=require(a7_0x15ec('0x17'));const file_storage_1=require('../../file-storage/file-storage');const e2e_encryption_1=require(a7_0x15ec('0x63'));const waiter_1=require(a7_0x15ec('0x10'));const environment_1=require('../../../utilities/environment');const print_run_group_error_1=require('../../error/print-run-group-error');const create_no_new_messages_timeout_1=require(a7_0x15ec('0x41'));const metric_logger_1=require(a7_0x15ec('0x7'));class NoopLifeCycle{[a7_0x15ec('0x4c')](_0x89a0b5){}[a7_0x15ec('0x67')](_0x4c76c2){}['endTask'](_0x7a2bb2,_0x43a0e0){}}function runDistributedExecution(_0x293f85,_0x3ffeee,_0x4664c2,_0x3d7461,_0x2ffd48,_0x2b80d6,_0xd5d63f){return __awaiter(this,void 0x0,void 0x0,function*(){const _0xb956d8=JSON[a7_0x15ec('0x5b')](stripJsonComments((0x0,fs_1['readFileSync'])(a7_0x15ec('0x19'))['toString']()));const _0x123f9b=new TaskOrderer(_0x4664c2[a7_0x15ec('0x29')],getDefaultDependencyConfigs(_0xb956d8,_0x3ffeee))[a7_0x15ec('0x27')](_0xd5d63f);const _0x591986=yield _0x293f85[a7_0x15ec('0x1d')]((0x0,distributed_execution_api_1[a7_0x15ec('0xa')])(_0x2b80d6,_0x123f9b,_0x3ffeee));return yield processTasks(_0x293f85,_0x3d7461,_0x2ffd48,_0x3ffeee,_0x591986,_0xd5d63f,_0x4664c2);});}function processTasks(_0x492227,_0x49b396,_0x75522c,_0xdd9daa,_0x237ee5,_0xe986f3,_0xc060a5){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3fcd25={};const _0x1ae46d=(0x0,create_no_new_messages_timeout_1[a7_0x15ec('0x8')])();const _0x589514=new waiter_1[(a7_0x15ec('0x2c'))]();while(!![]){if(environment_1[a7_0x15ec('0x22')]){output_1[a7_0x15ec('0x59')][a7_0x15ec('0x1')]({'title':a7_0x15ec('0x2a')});}yield _0x589514[a7_0x15ec('0xd')]();const _0x4f3a17=yield _0x492227['status'](_0x237ee5);if(environment_1[a7_0x15ec('0x22')]){output_1['output'][a7_0x15ec('0x1')]({'title':a7_0x15ec('0x66'),'bodyLines':[a7_0x15ec('0x4')+_0x237ee5,a7_0x15ec('0xb')+_0x4f3a17['executionStatus'],'number\x20of\x20completed\x20tasks:\x20'+_0x4f3a17[a7_0x15ec('0x3b')][a7_0x15ec('0x3a')],a7_0x15ec('0x2')+_0x4f3a17['criticalErrorMessage']]});}if(_0x4f3a17['criticalErrorMessage']){output_1[a7_0x15ec('0x59')]['error']({'title':a7_0x15ec('0x4f'),'bodyLines':[a7_0x15ec('0x16'),_0x4f3a17['criticalErrorMessage']]});process['exit'](0x1);}_0x1ae46d(_0x4f3a17[a7_0x15ec('0x3b')][a7_0x15ec('0x3a')]);for(const _0x3c619b of _0x4f3a17[a7_0x15ec('0x3b')]){if(_0x3fcd25[_0x3c619b['taskId']])continue;yield processTask(_0x49b396,_0x75522c,_0xc060a5,_0xdd9daa,_0xe986f3,_0x3c619b);_0x589514['reset']();_0x3fcd25[_0x3c619b['taskId']]=!![];}if(_0x4f3a17['executionStatus']===a7_0x15ec('0x4d')){return{'commandStatus':_0x4f3a17[a7_0x15ec('0x37')],'runUrl':_0x4f3a17[a7_0x15ec('0x46')]};}}});}function processTask(_0x1e75d6,_0x5d982f,_0x1799b7,_0x4b19eb,_0x12a5c6,_0x30dcc9){return __awaiter(this,void 0x0,void 0x0,function*(){if(environment_1['VERBOSE_LOGGING']){output_1[a7_0x15ec('0x59')][a7_0x15ec('0x1')]({'title':'Processing\x20task\x20'+_0x30dcc9[a7_0x15ec('0x4a')]});}const _0x2bad26=_0x12a5c6[a7_0x15ec('0x32')](_0x3d5644=>_0x30dcc9['taskId']===_0x3d5644['id']);if(!_0x2bad26){throw new Error('Found\x20unknown\x20task:\x20'+_0x30dcc9[a7_0x15ec('0x4a')]);}if(environment_1['VERBOSE_LOGGING']){output_1[a7_0x15ec('0x59')]['note']({'title':a7_0x15ec('0x38')+_0x30dcc9[a7_0x15ec('0x47')]});}yield _0x1e75d6[a7_0x15ec('0x48')](_0x30dcc9[a7_0x15ec('0x3f')],_0x30dcc9[a7_0x15ec('0x47')],_0x4b19eb[a7_0x15ec('0x64')]||a7_0x15ec('0x49'));const _0x46846a=yield _0x5d982f['get'](Object[a7_0x15ec('0x34')](Object['assign']({},_0x2bad26),{'hash':_0x30dcc9[a7_0x15ec('0x3f')]}));const _0x2d3d90=(0x0,utils_1[a7_0x15ec('0x1f')])(_0x1799b7['projectGraph'][a7_0x15ec('0x21')],_0x2bad26);if(environment_1[a7_0x15ec('0x22')]){output_1[a7_0x15ec('0x59')]['note']({'title':'Extracting\x20artifacts','bodyLines':_0x2d3d90});}yield _0x5d982f[a7_0x15ec('0x5e')](_0x30dcc9[a7_0x15ec('0x3f')],_0x46846a,_0x2d3d90);output_1[a7_0x15ec('0x59')][a7_0x15ec('0x56')](getCommand(_0x2bad26));process['stdout'][a7_0x15ec('0x5d')](_0x46846a['terminalOutput']);output_1[a7_0x15ec('0x59')][a7_0x15ec('0x28')]();});}function getCommand(_0x3e18cf){const _0x5cd4a2=(0x0,utils_1[a7_0x15ec('0x39')])(_0x3e18cf[a7_0x15ec('0xe')]||{});const _0x5a0b71=_0x3e18cf[a7_0x15ec('0x36')][a7_0x15ec('0x52')]?':'+_0x3e18cf[a7_0x15ec('0x36')]['configuration']:'';return['nx',a7_0x15ec('0x68'),_0x3e18cf[a7_0x15ec('0x36')][a7_0x15ec('0x57')]+':'+_0x3e18cf[a7_0x15ec('0x36')][a7_0x15ec('0x36')]+_0x5a0b71,..._0x5cd4a2][a7_0x15ec('0x35')]('\x20');}const nxCloudDistributedTasksRunner=(_0x54c7c8,_0x2191ef,_0x53851f)=>{if(environment_1[a7_0x15ec('0x22')]){output_1[a7_0x15ec('0x59')][a7_0x15ec('0x1')]({'title':a7_0x15ec('0x55')});}_0x2191ef[a7_0x15ec('0x3')]=new NoopLifeCycle();const _0x268f91=(0x0,environment_1['getRunGroup'])();if(!_0x268f91){(0x0,print_run_group_error_1['printRunGroupError'])();return process[a7_0x15ec('0x45')](0x1);}const _0x4007f3=new e2e_encryption_1[(a7_0x15ec('0x4b'))](environment_1[a7_0x15ec('0x5a')]||_0x2191ef[a7_0x15ec('0x43')]);const _0x5a577c=new file_storage_1[(a7_0x15ec('0x1b'))](_0x4007f3);const _0x136ba0=new cache_1[(a7_0x15ec('0x13'))](_0x2191ef);const _0x36077e=new distributed_execution_api_1['DistributedExecutionApi'](_0x2191ef);runDistributedExecution(_0x36077e,_0x2191ef,_0x53851f,_0x5a577c,_0x136ba0,_0x268f91,_0x54c7c8)[a7_0x15ec('0x18')](_0x5e8057=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(_0x5e8057[a7_0x15ec('0x37')]===0x0){output_1[a7_0x15ec('0x59')]['success']({'title':'Successfully\x20completed\x20running\x20the\x20command.','bodyLines':['See\x20run\x20details\x20at\x20'+_0x5e8057[a7_0x15ec('0x46')]]});}else{output_1[a7_0x15ec('0x59')][a7_0x15ec('0x42')]({'title':'Command\x20execution\x20failed.','bodyLines':[a7_0x15ec('0x44')+_0x5e8057[a7_0x15ec('0x46')]]});}yield(0x0,metric_logger_1[a7_0x15ec('0x53')])(_0x2191ef);process[a7_0x15ec('0x45')](_0x5e8057[a7_0x15ec('0x37')]);}))[a7_0x15ec('0x3d')](_0x8934eb=>{output_1[a7_0x15ec('0x59')]['error']({'title':a7_0x15ec('0x12'),'bodyLines':[_0x8934eb[a7_0x15ec('0x1e')]]});if(_0x8934eb[a7_0x15ec('0x2d')]){console[a7_0x15ec('0x62')](_0x8934eb[a7_0x15ec('0x2d')]);}else{console['log'](_0x8934eb);}_0x36077e[a7_0x15ec('0x58')](_0x268f91,'Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22'+_0x8934eb[a7_0x15ec('0x1e')]+'\x22')[a7_0x15ec('0x60')](()=>process[a7_0x15ec('0x45')](0x1));});return new Observable_1[(a7_0x15ec('0x61'))](()=>{});};exports[a7_0x15ec('0x54')]=nxCloudDistributedTasksRunner;class TaskOrderer{constructor(_0x2e59b1,_0x35a63a){this[a7_0x15ec('0x29')]=_0x2e59b1;this[a7_0x15ec('0x9')]=_0x35a63a;}['splitTasksIntoStages'](_0x5ca06e){if(_0x5ca06e[a7_0x15ec('0x3a')]===0x0)return[];const _0x4657be=[];const _0x56c21b=this['createTaskGraph'](_0x5ca06e);const _0x20970f=new Set(_0x5ca06e[a7_0x15ec('0x33')](_0x521362=>_0x521362['id']));let _0xee81e9=0x0;while(_0x20970f[a7_0x15ec('0x31')]>0x0){const _0x638c23=_0x4657be[_0xee81e9]=[];for(const _0x334ff7 of _0x20970f){let _0x17ad1f=!![];for(const _0x4ac0a6 of _0x56c21b[a7_0x15ec('0x40')][_0x334ff7]){if(_0x20970f[a7_0x15ec('0x1a')](_0x4ac0a6)){_0x17ad1f=![];break;}}if(!_0x17ad1f){continue;}const _0x4c94e1=_0x56c21b['tasks'][_0x334ff7];_0x638c23[a7_0x15ec('0x30')](_0x4c94e1);}for(const _0x290756 of _0x638c23){_0x20970f['delete'](_0x290756['id']);}_0xee81e9++;}return _0x4657be;}[a7_0x15ec('0x5c')](_0x1f1243){const _0x38f9e1=new TaskGraphCreator(this[a7_0x15ec('0x29')],this[a7_0x15ec('0x9')]);return _0x38f9e1[a7_0x15ec('0x5c')](_0x1f1243);}}class TaskGraphCreator{constructor(_0x267c66,_0x1ac70c){this[a7_0x15ec('0x29')]=_0x267c66;this[a7_0x15ec('0x9')]=_0x1ac70c;}['createTaskGraph'](_0x214778){const _0x56f5be={'roots':[],'tasks':{},'dependencies':{}};for(const _0x513fdc of _0x214778){this[a7_0x15ec('0x1c')](_0x513fdc,_0x56f5be);const _0x6cd18d=(0x0,utils_1[a7_0x15ec('0x50')])(_0x513fdc['target'],this[a7_0x15ec('0x9')],this[a7_0x15ec('0x29')]);if(!_0x6cd18d){continue;}this['addTaskDependencies'](_0x513fdc,_0x6cd18d,_0x214778,_0x56f5be);}_0x56f5be['roots']=Object[a7_0x15ec('0x0')](_0x56f5be[a7_0x15ec('0x40')])[a7_0x15ec('0x6')](_0x8c084c=>_0x56f5be[a7_0x15ec('0x40')][_0x8c084c]['length']===0x0);return _0x56f5be;}['addTaskDependencies'](_0x4f28b7,_0x4384d6,_0x271b46,_0x287f1c){for(const _0x22304f of _0x4384d6){if(_0x22304f['projects']===a7_0x15ec('0x14')){for(const _0x67c404 of _0x271b46){if(_0x67c404[a7_0x15ec('0x36')]['project']===_0x4f28b7['target'][a7_0x15ec('0x57')]&&_0x67c404[a7_0x15ec('0x36')][a7_0x15ec('0x36')]===_0x22304f[a7_0x15ec('0x36')]){_0x287f1c[a7_0x15ec('0x40')][_0x4f28b7['id']][a7_0x15ec('0x30')](_0x67c404['id']);}}}else if(_0x22304f[a7_0x15ec('0x26')]==='dependencies'){const _0x15d4ec=new Set();this[a7_0x15ec('0x3e')](_0x4f28b7[a7_0x15ec('0x36')][a7_0x15ec('0x57')],_0x22304f[a7_0x15ec('0x36')],_0x271b46,_0x287f1c,_0x4f28b7['id'],_0x15d4ec);}}}['addDependencies'](_0x2f57e8,_0x3109ac,_0x517d1f,_0x80b30c,_0x20bd94,_0x4af224){_0x4af224[a7_0x15ec('0x5f')](_0x2f57e8);const _0x5179fa=this['projectGraph'][a7_0x15ec('0x40')][_0x2f57e8];if(_0x5179fa){const _0x4a1a7c=_0x5179fa[a7_0x15ec('0x33')](_0x2d6ebb=>_0x2d6ebb[a7_0x15ec('0x36')]);for(const _0x96b581 of _0x4a1a7c){if(_0x4af224[a7_0x15ec('0x1a')](_0x96b581)){continue;}const _0x3fad50=this[a7_0x15ec('0x24')]({'project':_0x96b581,'target':_0x3109ac},_0x517d1f);if(_0x3fad50){if(_0x80b30c[a7_0x15ec('0x40')][_0x20bd94][a7_0x15ec('0x11')](_0x3fad50['id'])===-0x1){_0x80b30c[a7_0x15ec('0x40')][_0x20bd94][a7_0x15ec('0x30')](_0x3fad50['id']);}}else{this[a7_0x15ec('0x3e')](_0x96b581,_0x3109ac,_0x517d1f,_0x80b30c,_0x20bd94,_0x4af224);}}}}[a7_0x15ec('0x24')]({project,target},_0x2e57e2){return _0x2e57e2[a7_0x15ec('0x32')](_0x4479f8=>_0x4479f8[a7_0x15ec('0x36')]['project']===project&&_0x4479f8[a7_0x15ec('0x36')]['target']===target);}[a7_0x15ec('0x1c')](_0x580d30,_0x432b99){_0x432b99[a7_0x15ec('0x23')][_0x580d30['id']]=_0x580d30;_0x432b99[a7_0x15ec('0x40')][_0x580d30['id']]=[];}}exports[a7_0x15ec('0xc')]=TaskGraphCreator;function getDefaultDependencyConfigs(_0x146a87,_0x4c9cd3){var _0x21e1d5,_0xf45619;const _0x154835=(_0x21e1d5=_0x146a87[a7_0x15ec('0x2e')])!==null&&_0x21e1d5!==void 0x0?_0x21e1d5:{};const _0x5f2aaf=_0x4c9cd3?(_0xf45619=_0x4c9cd3[a7_0x15ec('0x15')])!==null&&_0xf45619!==void 0x0?_0xf45619:['build']:[];for(const _0x41678b of _0x5f2aaf){_0x154835[_0x41678b]=_0x154835[_0x41678b]||[];_0x154835[_0x41678b]['push']({'target':_0x41678b,'projects':a7_0x15ec('0x40')});}return _0x154835;}