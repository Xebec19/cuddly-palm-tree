const a6_0x545f=['data','recordMetric','status','done','/nx-cloud/executions/start','createApiAxiosInstance','createMetricRecorder','parallel','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','exit','output','apply','response','value','hash','apiAxiosInstance','configuration','throw','unparse','false','maxParallel','__esModule','true','error','then','agentCount','__awaiter','message','parseCommand','axiosMultipleTries','project','overrides','RUNNER_FAILURE_PERF_ENTRY','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','DistributedExecutionApi','defineProperty','/nx-cloud/executions/status','target','post','../../../utilities/axios','dteStatus','axiosException','createStartRequest','completeRunGroupWithError','enabled','@nrwl/workspace/src/utilities/output','mapRespToPerfEntry','@nrwl/workspace/src/tasks-runner/utils','../../../utilities/metric-logger','map'];(function(_0x5c2810,_0x545f38){const _0x258ef0=function(_0x1ca28f){while(--_0x1ca28f){_0x5c2810['push'](_0x5c2810['shift']());}};_0x258ef0(++_0x545f38);}(a6_0x545f,0x1e7));const a6_0x258e=function(_0x5c2810,_0x545f38){_0x5c2810=_0x5c2810-0x0;let _0x258ef0=a6_0x545f[_0x5c2810];return _0x258ef0;};'use strict';var __awaiter=this&&this[a6_0x258e('0x27')]||function(_0x282dcf,_0x2a58c5,_0x2d6073,_0x2280b4){function _0x1699e7(_0x4305a1){return _0x4305a1 instanceof _0x2d6073?_0x4305a1:new _0x2d6073(function(_0xd6cc7c){_0xd6cc7c(_0x4305a1);});}return new(_0x2d6073||(_0x2d6073=Promise))(function(_0x1538a3,_0x31eebc){function _0x116619(_0x5786ad){try{_0x3567e5(_0x2280b4['next'](_0x5786ad));}catch(_0x1e1428){_0x31eebc(_0x1e1428);}}function _0x5d52ff(_0x486cbf){try{_0x3567e5(_0x2280b4[a6_0x258e('0x1e')](_0x486cbf));}catch(_0x126477){_0x31eebc(_0x126477);}}function _0x3567e5(_0x2aaf3a){_0x2aaf3a[a6_0x258e('0x10')]?_0x1538a3(_0x2aaf3a[a6_0x258e('0x1a')]):_0x1699e7(_0x2aaf3a[a6_0x258e('0x1a')])[a6_0x258e('0x25')](_0x116619,_0x5d52ff);}_0x3567e5((_0x2280b4=_0x2280b4[a6_0x258e('0x18')](_0x282dcf,_0x2a58c5||[]))['next']());});};Object[a6_0x258e('0x30')](exports,a6_0x258e('0x22'),{'value':!![]});exports[a6_0x258e('0x5')]=exports[a6_0x258e('0x2f')]=void 0x0;const output_1=require(a6_0x258e('0x8'));const axios_1=require(a6_0x258e('0x2'));const utils_1=require(a6_0x258e('0xa'));const environment_1=require('../../../utilities/environment');const metric_logger_1=require(a6_0x258e('0xb'));class DistributedExecutionApi{constructor(_0x11f5bd){this[a6_0x258e('0x1c')]=(0x0,axios_1[a6_0x258e('0x12')])(_0x11f5bd);}['start'](_0x21a50b){var _0x116a08;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x48799b=(0x0,metric_logger_1['createMetricRecorder'])('dteStart');let _0x24f15b;try{_0x24f15b=yield(0x0,axios_1[a6_0x258e('0x2a')])(()=>this['apiAxiosInstance']['post'](a6_0x258e('0x11'),_0x21a50b));_0x48799b['recordMetric']((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x24f15b));}catch(_0x1fb140){_0x48799b['recordMetric'](((_0x116a08=_0x1fb140===null||_0x1fb140===void 0x0?void 0x0:_0x1fb140['axiosException'])===null||_0x116a08===void 0x0?void 0x0:_0x116a08['response'])?(0x0,metric_logger_1[a6_0x258e('0x9')])(_0x1fb140['axiosException'][a6_0x258e('0x19')]):metric_logger_1[a6_0x258e('0x2d')]);throw _0x1fb140;}if(!_0x24f15b[a6_0x258e('0xd')][a6_0x258e('0x7')]){throw new Error(a6_0x258e('0x2e'));}if(_0x24f15b['data']['error']){throw new Error(_0x24f15b[a6_0x258e('0xd')][a6_0x258e('0x24')]);}return _0x24f15b[a6_0x258e('0xd')]['id'];});}[a6_0x258e('0xf')](_0x13ccb8){var _0x190175;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x35f189=(0x0,metric_logger_1[a6_0x258e('0x13')])(a6_0x258e('0x3'));try{const _0x2ccffc=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a6_0x258e('0x1c')][a6_0x258e('0x1')](a6_0x258e('0x31'),{'id':_0x13ccb8}));_0x35f189[a6_0x258e('0xe')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x2ccffc));return _0x2ccffc[a6_0x258e('0xd')];}catch(_0x37efe0){_0x35f189['recordMetric'](((_0x190175=_0x37efe0===null||_0x37efe0===void 0x0?void 0x0:_0x37efe0[a6_0x258e('0x4')])===null||_0x190175===void 0x0?void 0x0:_0x190175[a6_0x258e('0x19')])?(0x0,metric_logger_1[a6_0x258e('0x9')])(_0x37efe0[a6_0x258e('0x4')]['response']):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);output_1[a6_0x258e('0x17')][a6_0x258e('0x24')]({'title':_0x37efe0[a6_0x258e('0x28')]});process[a6_0x258e('0x16')](0x1);}});}[a6_0x258e('0x6')](_0x211c53,_0x1224e8){var _0x232cce;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4a3e3c=(0x0,metric_logger_1[a6_0x258e('0x13')])('completeRunGroup');try{const _0x433532=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a6_0x258e('0x1c')]['post']('/nx-cloud/executions/complete-run-group',{'runGroup':_0x211c53,'criticalErrorMessage':_0x1224e8}),0x3);_0x4a3e3c[a6_0x258e('0xe')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x433532));}catch(_0x2cfe20){_0x4a3e3c[a6_0x258e('0xe')](((_0x232cce=_0x2cfe20===null||_0x2cfe20===void 0x0?void 0x0:_0x2cfe20['axiosException'])===null||_0x232cce===void 0x0?void 0x0:_0x232cce[a6_0x258e('0x19')])?(0x0,metric_logger_1[a6_0x258e('0x9')])(_0x2cfe20[a6_0x258e('0x4')][a6_0x258e('0x19')]):metric_logger_1[a6_0x258e('0x2d')]);}});}}exports['DistributedExecutionApi']=DistributedExecutionApi;function createStartRequest(_0x38fd67,_0x14621d,_0x2a9ed4){const _0x491d82=_0x14621d['map'](_0x3034e8=>{return _0x3034e8[a6_0x258e('0xc')](_0x3f4fcf=>{return{'taskId':_0x3f4fcf['id'],'hash':_0x3f4fcf[a6_0x258e('0x1b')],'projectName':_0x3f4fcf[a6_0x258e('0x0')][a6_0x258e('0x2b')],'target':_0x3f4fcf['target'][a6_0x258e('0x0')],'configuration':_0x3f4fcf[a6_0x258e('0x0')][a6_0x258e('0x1d')]||null,'params':(0x0,utils_1[a6_0x258e('0x1f')])(_0x3f4fcf[a6_0x258e('0x2c')])['join']('\x20')};});});const _0x189561={'command':(0x0,environment_1[a6_0x258e('0x29')])(),'branch':(0x0,environment_1['getBranch'])(),'runGroup':_0x38fd67,'tasks':_0x491d82,'maxParallel':calculateMaxParallel(_0x2a9ed4)};if(environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT']){_0x189561[a6_0x258e('0x26')]=environment_1[a6_0x258e('0x15')];}if(!environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE']){_0x189561['stopAgentsOnFailure']=![];}return _0x189561;}exports[a6_0x258e('0x5')]=createStartRequest;function calculateMaxParallel(_0x4bed18){if(_0x4bed18[a6_0x258e('0x14')]===a6_0x258e('0x20')||_0x4bed18[a6_0x258e('0x14')]===![]){return 0x1;}else if(_0x4bed18[a6_0x258e('0x14')]===a6_0x258e('0x23')||_0x4bed18[a6_0x258e('0x14')]===!![]){return Number(_0x4bed18['maxParallel']||0x3);}else if(_0x4bed18[a6_0x258e('0x14')]===undefined){return _0x4bed18[a6_0x258e('0x21')]?Number(_0x4bed18['maxParallel']):0x3;}else{return Number(_0x4bed18[a6_0x258e('0x14')])||0x3;}}