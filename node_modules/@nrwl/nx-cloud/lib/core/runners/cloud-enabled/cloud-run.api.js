const a3_0x406a=['headers','VERBOSE_LOGGING','terminalOutput','from','Invalid\x20end\x20run\x20response:\x20','status','Invalid\x20Nx\x20Cloud\x20response:\x20','../../../utilities/environment','/nx-cloud/runs/end','../../../utilities/metric-logger','getBranch','axiosMultipleTries','throw','output','done','success','promisify','unknown','response','getRunGroup','apiError','then','nxCloudVersion','runContext','startRun','@nrwl/workspace/src/utilities/output','data','axiosException','createMetricRecorder','...','readFileSync','endRun','value','RunStart','map','machineInfo','post','messages','toString','package.json','zlib','mapRespToPerfEntry','RunEnd.\x20Completed\x20tasks','runUrl','@nrwl/nx-cloud','application/octet-stream','extractErrorMessage','gzip','slice','apply','Nx\x20Cloud:\x20Unknown\x20Error\x20Occurred','stringify','error','api','Run\x20completion\x20responded\x20with\x20`undefined`.','createApiAxiosInstance','note','RUNNER_FAILURE_PERF_ENTRY','recordMetric','assign','message','../../../utilities/axios','Stack\x20Trace:','stack','next','urls','string','apiAxiosInstance','CloudRunApi','/nx-cloud/runs/start','devDependencies'];(function(_0x228a68,_0x406a64){const _0x367905=function(_0x4ad25f){while(--_0x4ad25f){_0x228a68['push'](_0x228a68['shift']());}};_0x367905(++_0x406a64);}(a3_0x406a,0xf5));const a3_0x3679=function(_0x228a68,_0x406a64){_0x228a68=_0x228a68-0x0;let _0x367905=a3_0x406a[_0x228a68];return _0x367905;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x335e38,_0x295a13,_0x58a897,_0x4bc7de){function _0x378883(_0x3d720e){return _0x3d720e instanceof _0x58a897?_0x3d720e:new _0x58a897(function(_0x3e6efe){_0x3e6efe(_0x3d720e);});}return new(_0x58a897||(_0x58a897=Promise))(function(_0x169e4a,_0x4aad9e){function _0x1032ba(_0x31167d){try{_0x4eb089(_0x4bc7de['next'](_0x31167d));}catch(_0x2e8152){_0x4aad9e(_0x2e8152);}}function _0x3b201(_0x2a83cc){try{_0x4eb089(_0x4bc7de[a3_0x3679('0x33')](_0x2a83cc));}catch(_0x2eed49){_0x4aad9e(_0x2eed49);}}function _0x4eb089(_0x29669e){_0x29669e[a3_0x3679('0x35')]?_0x169e4a(_0x29669e['value']):_0x378883(_0x29669e[a3_0x3679('0x0')])[a3_0x3679('0x3c')](_0x1032ba,_0x3b201);}_0x4eb089((_0x4bc7de=_0x4bc7de[a3_0x3679('0x11')](_0x335e38,_0x295a13||[]))[a3_0x3679('0x20')]());});};Object['defineProperty'](exports,'__esModule',{'value':!![]});exports['CloudRunApi']=void 0x0;const output_1=require(a3_0x3679('0x40'));const axios_1=require(a3_0x3679('0x1d'));const environment_1=require(a3_0x3679('0x2e'));const fs_1=require('fs');const zlib_1=require(a3_0x3679('0x8'));const util_1=require('util');const metric_logger_1=require(a3_0x3679('0x30'));class CloudRunApi{constructor(_0x188474,_0x4cedbb,_0x25e2c1,_0x357f1a){this['messages']=_0x188474;this[a3_0x3679('0x3e')]=_0x4cedbb;this['machineInfo']=_0x357f1a;this[a3_0x3679('0x23')]=(0x0,axios_1[a3_0x3679('0x17')])(_0x25e2c1);}['startRun'](_0x5ac15f,_0x5d5f90){var _0x4817bd;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x34761c=(0x0,metric_logger_1[a3_0x3679('0x43')])(a3_0x3679('0x3f'));try{const _0x14e33f={'meta':{'nxCloudVersion':this['nxCloudVersion']()},'branch':(0x0,environment_1[a3_0x3679('0x31')])(),'runGroup':(0x0,environment_1[a3_0x3679('0x3a')])(),'distributedExecutionId':_0x5ac15f,'hashes':_0x5d5f90};if(environment_1['VERBOSE_LOGGING']){output_1['output'][a3_0x3679('0x18')]({'title':a3_0x3679('0x1'),'bodyLines':['\x0a'+JSON[a3_0x3679('0x13')](_0x14e33f,null,0x2)]});}const _0x2557e3=yield(0x0,axios_1[a3_0x3679('0x32')])(()=>this[a3_0x3679('0x23')][a3_0x3679('0x4')](a3_0x3679('0x25'),_0x14e33f));_0x34761c[a3_0x3679('0x1a')]((0x0,metric_logger_1[a3_0x3679('0x9')])(_0x2557e3));if(_0x2557e3['data']&&_0x2557e3[a3_0x3679('0x41')][a3_0x3679('0x1c')]){this['messages']['message']=_0x2557e3[a3_0x3679('0x41')][a3_0x3679('0x1c')];}if(!_0x2557e3['data']||!_0x2557e3[a3_0x3679('0x41')]['urls']){this[a3_0x3679('0x5')]['apiError']=a3_0x3679('0x2d')+JSON[a3_0x3679('0x13')](_0x2557e3['data']);return{};}return _0x2557e3[a3_0x3679('0x41')][a3_0x3679('0x21')];}catch(_0x115ac2){_0x34761c[a3_0x3679('0x1a')](((_0x4817bd=_0x115ac2===null||_0x115ac2===void 0x0?void 0x0:_0x115ac2[a3_0x3679('0x42')])===null||_0x4817bd===void 0x0?void 0x0:_0x4817bd[a3_0x3679('0x39')])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x115ac2[a3_0x3679('0x42')][a3_0x3679('0x39')]):metric_logger_1[a3_0x3679('0x19')]);this[a3_0x3679('0x5')][a3_0x3679('0x3b')]=this[a3_0x3679('0x5')][a3_0x3679('0xe')](_0x115ac2,a3_0x3679('0x15'));return{};}});}[a3_0x3679('0x46')](_0x526bd2,_0x4cce65){var _0xe1b487,_0xc6415a;return __awaiter(this,void 0x0,void 0x0,function*(){if(this[a3_0x3679('0x5')][a3_0x3679('0x3b')])return![];const _0x228773={'meta':{'nxCloudVersion':this[a3_0x3679('0x3d')]()},'tasks':_0x4cce65,'run':_0x526bd2,'machineInfo':this[a3_0x3679('0x3')]};const _0x1696b6=Buffer[a3_0x3679('0x2a')](JSON[a3_0x3679('0x13')](_0x228773));const _0x179949=yield(0x0,util_1[a3_0x3679('0x37')])(zlib_1[a3_0x3679('0xf')])(_0x1696b6);const _0x49c718=(0x0,metric_logger_1[a3_0x3679('0x43')])(a3_0x3679('0x46'));try{if(environment_1[a3_0x3679('0x28')]){const _0x132e6f=_0x4cce65[a3_0x3679('0x2')](_0x21feee=>{return Object[a3_0x3679('0x1b')](Object['assign']({},_0x21feee),{'terminalOutput':_0x21feee[a3_0x3679('0x29')]?_0x21feee['terminalOutput'][a3_0x3679('0x10')](0x0,0x14)+a3_0x3679('0x44'):undefined});});output_1['output']['note']({'title':a3_0x3679('0xa'),'bodyLines':['\x0a'+JSON[a3_0x3679('0x13')](_0x132e6f,null,0x2)]});}const _0x2a3b97=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a3_0x3679('0x23')][a3_0x3679('0x4')](a3_0x3679('0x2f'),_0x179949,{'headers':Object[a3_0x3679('0x1b')](Object[a3_0x3679('0x1b')]({},this['apiAxiosInstance']['defaults'][a3_0x3679('0x27')]),{'Content-Encoding':'gzip','Content-Type':a3_0x3679('0xd')})}));if(_0x2a3b97){_0x49c718['recordMetric']((0x0,metric_logger_1[a3_0x3679('0x9')])(_0x2a3b97));if(_0x2a3b97[a3_0x3679('0x41')]&&_0x2a3b97['data'][a3_0x3679('0xb')]&&_0x2a3b97[a3_0x3679('0x41')][a3_0x3679('0x2c')]===a3_0x3679('0x36')){this[a3_0x3679('0x3e')][a3_0x3679('0xb')]=_0x2a3b97['data'][a3_0x3679('0xb')];return!![];}if(_0x2a3b97[a3_0x3679('0x41')]&&_0x2a3b97[a3_0x3679('0x41')][a3_0x3679('0x2c')]){this[a3_0x3679('0x5')]['apiError']=a3_0x3679('0x2b')+JSON[a3_0x3679('0x13')](_0x2a3b97[a3_0x3679('0x41')][a3_0x3679('0x1c')]);}else if(_0x2a3b97[a3_0x3679('0x41')]&&typeof _0x2a3b97[a3_0x3679('0x41')]===a3_0x3679('0x22')){if(_0x2a3b97[a3_0x3679('0x41')]!==a3_0x3679('0x36')){this[a3_0x3679('0x5')][a3_0x3679('0x3b')]=a3_0x3679('0x2b')+JSON[a3_0x3679('0x13')](_0x2a3b97[a3_0x3679('0x41')]);}}else{this[a3_0x3679('0x5')][a3_0x3679('0x3b')]=a3_0x3679('0x2b')+JSON[a3_0x3679('0x13')](_0x2a3b97[a3_0x3679('0x41')]);}if(environment_1[a3_0x3679('0x28')]){output_1[a3_0x3679('0x34')]['note']({'title':'Invalid\x20end\x20run\x20response','bodyLines':[JSON[a3_0x3679('0x13')](_0x2a3b97[a3_0x3679('0x41')],null,0x2)]});}}else{output_1[a3_0x3679('0x34')][a3_0x3679('0x14')]({'title':a3_0x3679('0x12'),'bodyLines':[a3_0x3679('0x16'),'Run\x20Details:',JSON[a3_0x3679('0x13')](_0x526bd2,null,0x2),a3_0x3679('0x1e'),JSON['stringify'](new Error()[a3_0x3679('0x1f')],null,0x2)]});}return![];}catch(_0xecd003){_0x49c718['recordMetric'](((_0xe1b487=_0xecd003===null||_0xecd003===void 0x0?void 0x0:_0xecd003[a3_0x3679('0x42')])===null||_0xe1b487===void 0x0?void 0x0:_0xe1b487[a3_0x3679('0x39')])?(0x0,metric_logger_1[a3_0x3679('0x9')])(_0xecd003[a3_0x3679('0x42')][a3_0x3679('0x39')]):metric_logger_1[a3_0x3679('0x19')]);const _0x59ee0c=(_0xc6415a=_0xecd003[a3_0x3679('0x42')])!==null&&_0xc6415a!==void 0x0?_0xc6415a:_0xecd003;this['messages'][a3_0x3679('0x3b')]=this[a3_0x3679('0x5')][a3_0x3679('0xe')](_0x59ee0c,a3_0x3679('0x15'));return![];}});}[a3_0x3679('0x3d')](){try{const _0x13904f=JSON['parse']((0x0,fs_1[a3_0x3679('0x45')])(a3_0x3679('0x7'))[a3_0x3679('0x6')]());return _0x13904f[a3_0x3679('0x26')][a3_0x3679('0xc')];}catch(_0xaeeea){return a3_0x3679('0x38');}}}exports[a3_0x3679('0x24')]=CloudRunApi;